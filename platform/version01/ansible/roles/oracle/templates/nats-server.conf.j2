host: 0.0.0.0
port: {{ hostvars[inventory_hostname].nats_port }}

server_name: {{ hostvars[inventory_hostname].ansible_name }}

http_port: 8222

leafnodes: {
    port: {{ hostvars[inventory_hostname].leaf_port }}
}

websocket: {
    port: {{ hostvars[inventory_hostname].socket_port }}
    no_tls: true
}

jetstream: enabled

jetstream: {
    store_dir: /srv/nats/storage
    domain: wasmcloud
}

cluster: {
    name: {{ name_cluster }}

    listen: {{ hostvars[inventory_hostname].ansible_host }}:{{ hostvars[inventory_hostname].cluster_port }}

    authorization: {
        user: route_user
        password: pwd
        timeout: 0.5
    }

    routes: [
{% for server in groups['servers'] %}
        nats://route_user:pwd@{{ hostvars[server].ansible_host }}:{{ hostvars[server].cluster_port }}
{% endfor %}
    ]
}

#include resolver.conf
